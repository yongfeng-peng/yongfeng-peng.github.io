<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="reactç”Ÿå‘½å‘¨æœŸ å›¾è°±react v16.0å‰çš„ç”Ÿå‘½å‘¨æœŸ å¤§éƒ¨åˆ†å›¢é˜Ÿä¸è§å¾—ä¼šè·Ÿè¿›å‡åˆ°16ç‰ˆæœ¬ï¼Œæ‰€ä»¥16å‰çš„ç”Ÿå‘½å‘¨æœŸè¿˜æ˜¯å¾ˆæœ‰å¿…è¦æŒæ¡çš„ï¼Œä½•å†µ16ä¹Ÿæ˜¯åŸºäºä¹‹å‰çš„ä¿®æ”¹ ç¬¬ä¸€ç»„ä»¶åˆå§‹åŒ–(initialization)é˜¶æ®µ  ç±»çš„æ„é€ æ–¹æ³•( constructor() ),Testç±»ç»§æ‰¿äº†react Componentè¿™ä¸ªåŸºç±»ï¼Œå³ç»§æ‰¿è¿™ä¸ªreactçš„åŸºç±»ï¼Œæ‰èƒ½æœ‰render(),ç”Ÿå‘½å‘¨æœŸç­‰æ–¹æ³•å¯ä»¥ä½¿ç”¨ï¼Œ">
<meta property="og:type" content="article">
<meta property="og:title" content="reactç”Ÿå‘½å‘¨æœŸ">
<meta property="og:url" content="http://yoursite.com/2020/12/22/reactç”Ÿå‘½å‘¨æœŸ/index.html">
<meta property="og:site_name" content="Shero.">
<meta property="og:description" content="reactç”Ÿå‘½å‘¨æœŸ å›¾è°±react v16.0å‰çš„ç”Ÿå‘½å‘¨æœŸ å¤§éƒ¨åˆ†å›¢é˜Ÿä¸è§å¾—ä¼šè·Ÿè¿›å‡åˆ°16ç‰ˆæœ¬ï¼Œæ‰€ä»¥16å‰çš„ç”Ÿå‘½å‘¨æœŸè¿˜æ˜¯å¾ˆæœ‰å¿…è¦æŒæ¡çš„ï¼Œä½•å†µ16ä¹Ÿæ˜¯åŸºäºä¹‹å‰çš„ä¿®æ”¹ ç¬¬ä¸€ç»„ä»¶åˆå§‹åŒ–(initialization)é˜¶æ®µ  ç±»çš„æ„é€ æ–¹æ³•( constructor() ),Testç±»ç»§æ‰¿äº†react Componentè¿™ä¸ªåŸºç±»ï¼Œå³ç»§æ‰¿è¿™ä¸ªreactçš„åŸºç±»ï¼Œæ‰èƒ½æœ‰render(),ç”Ÿå‘½å‘¨æœŸç­‰æ–¹æ³•å¯ä»¥ä½¿ç”¨ï¼Œ">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-12-22T03:12:29.492Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="reactç”Ÿå‘½å‘¨æœŸ">
<meta name="twitter:description" content="reactç”Ÿå‘½å‘¨æœŸ å›¾è°±react v16.0å‰çš„ç”Ÿå‘½å‘¨æœŸ å¤§éƒ¨åˆ†å›¢é˜Ÿä¸è§å¾—ä¼šè·Ÿè¿›å‡åˆ°16ç‰ˆæœ¬ï¼Œæ‰€ä»¥16å‰çš„ç”Ÿå‘½å‘¨æœŸè¿˜æ˜¯å¾ˆæœ‰å¿…è¦æŒæ¡çš„ï¼Œä½•å†µ16ä¹Ÿæ˜¯åŸºäºä¹‹å‰çš„ä¿®æ”¹ ç¬¬ä¸€ç»„ä»¶åˆå§‹åŒ–(initialization)é˜¶æ®µ  ç±»çš„æ„é€ æ–¹æ³•( constructor() ),Testç±»ç»§æ‰¿äº†react Componentè¿™ä¸ªåŸºç±»ï¼Œå³ç»§æ‰¿è¿™ä¸ªreactçš„åŸºç±»ï¼Œæ‰èƒ½æœ‰render(),ç”Ÿå‘½å‘¨æœŸç­‰æ–¹æ³•å¯ä»¥ä½¿ç”¨ï¼Œ">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/12/22/reactç”Ÿå‘½å‘¨æœŸ/">





  <title>reactç”Ÿå‘½å‘¨æœŸ | Shero.</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas>
  <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
  <script type="text/javascript" src="/js/src/fireworks.js"></script>
  

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Shero.</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ç”Ÿæ´»ç™¾èˆ¬æ»‹å‘³ï¼Œä½ è¦ç¬‘ç€é¢å¯¹ğŸ˜Š</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/22/reactç”Ÿå‘½å‘¨æœŸ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yongfeng.peng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/blog-avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shero.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">reactç”Ÿå‘½å‘¨æœŸ</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-22T09:52:44+08:00">
                2020-12-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/å‰ç«¯æ¡†æ¶/" itemprop="url" rel="index">
                    <span itemprop="name">å‰ç«¯æ¡†æ¶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="reactç”Ÿå‘½å‘¨æœŸ-å›¾è°±"><a href="#reactç”Ÿå‘½å‘¨æœŸ-å›¾è°±" class="headerlink" title="reactç”Ÿå‘½å‘¨æœŸ å›¾è°±"></a>reactç”Ÿå‘½å‘¨æœŸ <a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" target="_blank" rel="noopener">å›¾è°±</a></h3><h4 id="react-v16-0å‰çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#react-v16-0å‰çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="react v16.0å‰çš„ç”Ÿå‘½å‘¨æœŸ"></a>react v16.0å‰çš„ç”Ÿå‘½å‘¨æœŸ</h4><ul>
<li>å¤§éƒ¨åˆ†å›¢é˜Ÿä¸è§å¾—ä¼šè·Ÿè¿›å‡åˆ°16ç‰ˆæœ¬ï¼Œæ‰€ä»¥16å‰çš„ç”Ÿå‘½å‘¨æœŸè¿˜æ˜¯å¾ˆæœ‰å¿…è¦æŒæ¡çš„ï¼Œä½•å†µ16ä¹Ÿæ˜¯åŸºäºä¹‹å‰çš„ä¿®æ”¹</li>
<li><p>ç¬¬ä¸€ç»„ä»¶åˆå§‹åŒ–(initialization)é˜¶æ®µ</p>
<ul>
<li>ç±»çš„æ„é€ æ–¹æ³•( constructor() ),Testç±»ç»§æ‰¿äº†react Componentè¿™ä¸ªåŸºç±»ï¼Œå³ç»§æ‰¿è¿™ä¸ª<strong>reactçš„åŸºç±»</strong>ï¼Œæ‰èƒ½æœ‰render(),ç”Ÿå‘½å‘¨æœŸç­‰æ–¹æ³•å¯ä»¥ä½¿ç”¨ï¼Œ ä¹Ÿæ˜¯å‡½æ•°ç»„ä»¶ä¸èƒ½ä½¿ç”¨è¿™äº›æ–¹æ³•çš„åŸå› ã€‚</li>
<li>super(props) ç”¨æ¥è°ƒç”¨åŸºç±»çš„æ„é€ æ–¹æ³•( constructor() ), ä¹Ÿå°†çˆ¶ç»„ä»¶çš„propsæ³¨å…¥ç»™å­ç»„ä»¶ï¼Œä¾›å­ç»„ä»¶è¯»å–(ç»„ä»¶ä¸­propsåªè¯»ä¸å¯å˜ï¼Œstateå¯å˜)ã€‚ è€Œ constructor() ç”¨æ¥åšä¸€äº›ç»„ä»¶çš„åˆå§‹åŒ–å·¥ä½œï¼Œå¦‚å®šä¹‰this.stateçš„åˆå§‹å†…å®¹<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line">class Test extends Component &#123; </span><br><span class="line">  constructor(props) &#123; </span><br><span class="line">    super(props); </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>ç¬¬äºŒç»„ä»¶çš„æŒ‚è½½(Mounting)é˜¶æ®µ</p>
<ul>
<li>æ­¤é˜¶æ®µåˆ†ä¸ºcomponentWillMountï¼Œrenderï¼ŒcomponentDidMountä¸‰ä¸ªæ—¶æœŸ</li>
<li>componentWillMount<ul>
<li>åœ¨ç»„ä»¶æŒ‚è½½åˆ°DOMå‰è°ƒç”¨ï¼Œä¸”åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨è¿™è¾¹è°ƒç”¨<strong>this.setStateä¸ä¼šå¼•èµ·ç»„ä»¶é‡æ–°æ¸²æŸ“</strong>ï¼Œå¯æŠŠè¿™é‡Œçš„å†…å®¹æå‰åˆ°constructor()ä¸­ï¼Œæ‰€ä»¥é¡¹ç›®ä¸­å¾ˆå°‘ç”¨</li>
</ul>
</li>
<li>render<ul>
<li>æ ¹æ®ç»„ä»¶çš„propså’Œstateï¼ˆæ— ä¸¤è€…çš„é‡ä¼ é€’å’Œé‡èµ‹å€¼ï¼Œè®ºå€¼æ˜¯å¦æœ‰å˜åŒ–ï¼Œéƒ½å¯ä»¥å¼•èµ·ç»„ä»¶é‡æ–°renderï¼‰ ï¼Œreturnä¸€ä¸ªReactå…ƒç´ ï¼ˆæè¿°ç»„ä»¶ï¼Œå³UIï¼‰ï¼Œä¸è´Ÿè´£ç»„ä»¶å®é™…æ¸²æŸ“å·¥ä½œï¼Œä¹‹åç”±Reactè‡ªèº«æ ¹æ®æ­¤å…ƒç´ å»æ¸²æŸ“å‡ºé¡µé¢<br>DOMã€‚renderæ˜¯çº¯å‡½æ•°ï¼ˆPure functionï¼šå‡½æ•°çš„è¿”å›ç»“æœåªä¾èµ–äºå®ƒçš„å‚æ•°ï¼›å‡½æ•°æ‰§è¡Œè¿‡ç¨‹é‡Œé¢æ²¡æœ‰å‰¯ä½œç”¨ï¼‰ï¼Œä¸èƒ½åœ¨é‡Œé¢æ‰§è¡Œthis.setStateï¼Œä¼šæœ‰æ”¹å˜ç»„ä»¶çŠ¶æ€çš„å‰¯ä½œç”¨</li>
</ul>
</li>
<li>componentDidMount<ul>
<li>ç»„ä»¶æŒ‚è½½åˆ°DOMåè°ƒç”¨ï¼Œä¸”åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡</li>
</ul>
</li>
</ul>
</li>
<li><p>ç¬¬ä¸‰ç»„ä»¶çš„æ›´æ–°(update)é˜¶æ®µ</p>
<ul>
<li>æ­¤é˜¶æ®µåˆ†ä¸ºcomponentWillReceivePropsï¼ŒshouldComponentUpdateï¼ŒcomponentWillUpdateï¼Œrenderï¼ŒcomponentDidUpdate</li>
<li>componentWillReceiveProps(nextProps)<ul>
<li>åªè°ƒç”¨äºpropså¼•èµ·çš„ç»„ä»¶æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œå‚æ•°nextPropsæ˜¯çˆ¶ç»„ä»¶ä¼ ç»™å½“å‰ç»„ä»¶çš„æ–°propsã€‚ä½†çˆ¶ç»„ä»¶renderæ–¹æ³•çš„è°ƒç”¨ä¸èƒ½ä¿è¯é‡ä¼ ç»™å½“å‰ç»„ä»¶çš„propsæ˜¯æœ‰å˜åŒ–çš„ï¼Œæ‰€ä»¥åœ¨æ­¤æ–¹æ³•ä¸­æ ¹æ®nextPropså’Œthis.propsæ¥æŸ¥æ˜é‡ä¼ çš„propsæ˜¯å¦æ”¹å˜ï¼Œä»¥åŠå¦‚æœæ”¹å˜äº†è¦æ‰§è¡Œå•¥ï¼Œæ¯”å¦‚æ ¹æ®æ–°çš„propsè°ƒç”¨this.setStateå‡ºå‘å½“å‰ç»„ä»¶çš„é‡æ–°render</li>
</ul>
</li>
<li>shouldComponentUpdate(nextProps, nextState)<ul>
<li>é€šè¿‡æ¯”è¾ƒnextPropsï¼ŒnextStateåŠå½“å‰ç»„ä»¶çš„this.propsï¼Œthis.stateï¼Œè¿”å›trueæ—¶å½“å‰ç»„ä»¶å°†ç»§ç»­æ‰§è¡Œæ›´æ–°è¿‡ç¨‹ï¼Œè¿”å›falseåˆ™å½“å‰ç»„ä»¶æ›´æ–°åœæ­¢ï¼Œä»¥æ­¤å¯ç”¨æ¥å‡å°‘ç»„ä»¶çš„ä¸å¿…è¦æ¸²æŸ“ï¼Œä¼˜åŒ–ç»„ä»¶æ€§èƒ½</li>
<li>psï¼šè¿™è¾¹ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå°±ç®—componentWillReceiveProps()ä¸­æ‰§è¡Œäº†this.setStateï¼Œæ›´æ–°äº†stateï¼Œä½†åœ¨renderå‰ï¼ˆå¦‚shouldComponentUpdateï¼ŒcomponentWillUpdateï¼‰ï¼Œthis.stateä¾ç„¶æŒ‡å‘æ›´æ–°å‰çš„stateï¼Œä¸ç„¶nextStateåŠå½“å‰ç»„ä»¶çš„this.stateçš„å¯¹æ¯”å°±ä¸€ç›´æ˜¯trueäº†</li>
</ul>
</li>
<li>componentWillUpdate(nextProps, nextState)<ul>
<li>åœ¨è°ƒç”¨renderæ–¹æ³•å‰æ‰§è¡Œï¼Œåœ¨è¿™è¾¹å¯æ‰§è¡Œä¸€äº›ç»„ä»¶æ›´æ–°å‘ç”Ÿå‰çš„å·¥ä½œï¼Œä¸€èˆ¬è¾ƒå°‘ç”¨</li>
</ul>
</li>
<li>render<ul>
<li>renderæ–¹æ³•åœ¨ä¸Šæ–‡è®²è¿‡ï¼Œè¿™è¾¹åªæ˜¯é‡æ–°è°ƒç”¨</li>
</ul>
</li>
<li>componentDidUpdate(prevProps, prevState)<ul>
<li>åœ¨ç»„ä»¶æ›´æ–°åè¢«è°ƒç”¨ï¼Œå¯ä»¥æ“ä½œç»„ä»¶æ›´æ–°çš„DOMï¼ŒprevPropså’ŒprevStateè¿™ä¸¤ä¸ªå‚æ•°æŒ‡çš„æ˜¯ç»„ä»¶æ›´æ–°å‰çš„propså’Œstate</li>
</ul>
</li>
<li><p>äº†è§£æ­¤é˜¶æ®µå‰éœ€è¦å…ˆæ˜ç¡®ä¸‹reactç»„ä»¶æ›´æ–°æœºåˆ¶ã€‚setStateå¼•èµ·çš„stateæ›´æ–°æˆ–çˆ¶ç»„ä»¶é‡æ–°renderå¼•èµ·çš„propsæ›´æ–°ï¼Œæ›´æ–°åçš„stateå’Œpropsç›¸å¯¹ä¹‹å‰æ— è®ºæ˜¯å¦æœ‰å˜åŒ–ï¼Œéƒ½å°†å¼•èµ·å­ç»„ä»¶çš„é‡æ–°renderã€‚è¯¦ç»†å¯çœ‹<a href="https://www.cnblogs.com/penghuwan/p/6707254.html&#39;" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>é€ æˆç»„ä»¶æ›´æ–°æœ‰ä¸¤ç±»ï¼ˆä¸‰ç§ï¼‰æƒ…å†µï¼š<br>1.çˆ¶ç»„ä»¶é‡æ–°renderï¼ˆçˆ¶ç»„ä»¶é‡æ–°renderå¼•èµ·å­ç»„ä»¶é‡æ–°renderçš„æƒ…å†µæœ‰ä¸¤ç§ï¼‰<br>a. ç›´æ¥ä½¿ç”¨,æ¯å½“çˆ¶ç»„ä»¶é‡æ–°renderå¯¼è‡´çš„é‡ä¼ propsï¼Œå­ç»„ä»¶å°†ç›´æ¥è·Ÿç€é‡æ–°æ¸²æŸ“ï¼Œæ— è®ºpropsæ˜¯å¦æœ‰å˜åŒ–ã€‚å¯é€šè¿‡shouldComponentUpdateæ–¹æ³•ä¼˜åŒ–</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class Child extends Component &#123; </span><br><span class="line">  shouldComponentUpdate(nextProps)&#123; // åº”è¯¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¦åˆ™æ— è®ºpropsæ˜¯å¦æœ‰å˜åŒ–éƒ½å°†ä¼šå¯¼è‡´ç»„ä»¶ è·Ÿç€é‡æ–°æ¸²æŸ“</span><br><span class="line">    if(nextProps.someThings === this.props.someThings) &#123; </span><br><span class="line">      return false;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123; </span><br><span class="line">    return &lt;div&gt;&#123;this.props.someThings&#125;&lt;/div&gt; </span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>b.åœ¨componentWillReceivePropsæ–¹æ³•ä¸­ï¼Œå°†propsè½¬æ¢æˆè‡ªå·±çš„state</p>
<ul>
<li>å‡½æ•°(componentWillReceiveProps)ä¸­è°ƒç”¨ this.setState() å°†ä¸ä¼šå¼•èµ·ç¬¬äºŒæ¬¡æ¸²æŸ“</li>
<li>componentWillReceivePropsä¸­åˆ¤æ–­propsæ˜¯å¦å˜åŒ–äº†ï¼Œè‹¥å˜åŒ–äº†ï¼Œthis.setStateå°†å¼•èµ·stateå˜åŒ–ï¼Œä»è€Œå¼•èµ·renderï¼Œæ­¤æ—¶å°±æ²¡å¿…è¦å†åšç¬¬äºŒæ¬¡å› é‡ä¼ propså¼•èµ·çš„renderäº†ï¼Œä¸ç„¶é‡å¤åšä¸€æ ·çš„æ¸²æŸ“äº†<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class Child extends Component &#123; </span><br><span class="line">  constructor(props) &#123; </span><br><span class="line">    super(props); </span><br><span class="line">    this.state = &#123; </span><br><span class="line">      someThings: props.someThings </span><br><span class="line">    &#125;; </span><br><span class="line">  &#125;</span><br><span class="line">  componentWillReceiveProps(nextProps) &#123; // çˆ¶ç»„ä»¶é‡ä¼ propsæ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³• </span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      someThings: nextProps.someThings</span><br><span class="line">    &#125;); </span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123; </span><br><span class="line">    return &lt;div&gt;&#123;this.state.someThings&#125;&lt;/div&gt; </span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>2.ç»„ä»¶æœ¬èº«è°ƒç”¨setStateï¼Œæ— è®ºstateæœ‰æ²¡æœ‰å˜åŒ–ã€‚å¯é€šè¿‡shouldComponentUpdateæ–¹æ³•ä¼˜åŒ–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">class Child extends Component &#123; </span><br><span class="line">  constructor(props) &#123; </span><br><span class="line">    super(props); </span><br><span class="line">    this.state = &#123; </span><br><span class="line">      someThings:1 </span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">  shouldComponentUpdate(nextStates) &#123; // åº”è¯¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¦åˆ™æ— è®ºstateæ˜¯å¦æœ‰å˜åŒ–éƒ½å°†ä¼šå¯¼è‡´ç»„ ä»¶é‡æ–°æ¸²æŸ“</span><br><span class="line">    if(nextStates.someThings === this.state.someThings) &#123; </span><br><span class="line">      return false;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">  handleClick = () =&gt; &#123; // è™½ç„¶è°ƒç”¨äº†setState ï¼Œä½†stateå¹¶æ— å˜åŒ– </span><br><span class="line">    const preSomeThings = this.state.someThings;</span><br><span class="line">    this.setState(&#123; </span><br><span class="line">      someThings: preSomeThings </span><br><span class="line">    &#125;) </span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123; </span><br><span class="line">    return &lt;div onClick = &#123;this.handleClick&#125;&gt;&#123;this.state.someThings&#125;&lt;/div&gt; </span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>ç¬¬å››å¸è½½é˜¶æ®µ</p>
<ul>
<li>åªæœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼šcomponentWillUnmount</li>
<li>componentWillUnmount<ul>
<li>åœ¨ç»„ä»¶è¢«å¸è½½å‰è°ƒç”¨ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œæ¯”å¦‚æ¸…é™¤ç»„ä»¶ä¸­ä½¿ç”¨çš„å®šæ—¶å™¨ï¼Œæ¸…é™¤componentDidMountä¸­æ‰‹åŠ¨åˆ›å»ºçš„DOMå…ƒç´ ç­‰ï¼Œä»¥é¿å…å¼•èµ·å†…å­˜æ³„æ¼</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="react-v16-4-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#react-v16-4-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="react v16.4 çš„ç”Ÿå‘½å‘¨æœŸ"></a>react v16.4 çš„ç”Ÿå‘½å‘¨æœŸ</h4><ul>
<li>å˜æ›´ç¼˜ç”±<ul>
<li>åŸæ¥ï¼ˆReact v16.0å‰ï¼‰çš„ç”Ÿå‘½å‘¨æœŸåœ¨React v16æ¨å‡ºçš„<a href="https://zhuanlan.zhihu.com/p/26027085" target="_blank" rel="noopener">Fiber</a>ä¹‹åå°±ä¸åˆé€‚äº†ï¼Œå› ä¸ºå¦‚æœè¦å¼€å¯async renderingï¼Œ åœ¨renderå‡½æ•°ä¹‹å‰çš„æ‰€æœ‰å‡½æ•°ï¼Œéƒ½æœ‰å¯èƒ½è¢«æ‰§è¡Œå¤šæ¬¡</li>
</ul>
</li>
<li>åŸæ¥ï¼ˆReact v16.0å‰ï¼‰çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›æ˜¯åœ¨renderå‰æ‰§è¡Œçš„å‘¢ï¼Ÿ<ul>
<li>componentWillMount</li>
<li>componentWillReceiveProps</li>
<li>shouldComponentUpdate</li>
<li>componentWillUpdate</li>
</ul>
</li>
<li>å¦‚æœå¼€å‘è€…å¼€äº†async renderingï¼Œè€Œä¸”åˆåœ¨ä»¥ä¸Šè¿™äº›renderå‰æ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åšAJAXè¯·æ±‚çš„è¯ï¼Œé‚£AJAXå°†è¢«æ— è°“åœ°å¤šæ¬¡è°ƒç”¨ã€‚æ˜æ˜¾ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ç»“æœã€‚è€Œä¸”åœ¨componentWillMounté‡Œå‘èµ·AJAXï¼Œä¸ç®¡å¤šå¿«å¾—åˆ°ç»“æœä¹Ÿèµ¶ä¸ä¸Šé¦–æ¬¡renderï¼Œè€Œä¸”componentWillMountåœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“ä¹Ÿä¼šè¢«è°ƒç”¨åˆ°ï¼ˆå½“ç„¶ï¼Œä¹Ÿè®¸è¿™æ˜¯é¢„æœŸçš„ç»“æœï¼‰ï¼Œè¿™æ ·çš„IOæ“ä½œæ”¾åœ¨componentDidMounté‡Œæ›´åˆé€‚ã€‚ç¦æ­¢ä¸èƒ½ç”¨æ¯”åŠå¯¼å¼€å‘è€…ä¸è¦è¿™æ ·ç”¨çš„æ•ˆæœæ›´å¥½ï¼Œæ‰€ä»¥é™¤äº†shouldComponentUpdateï¼Œå…¶ä»–åœ¨renderå‡½æ•°ä¹‹å‰çš„æ‰€æœ‰å‡½æ•°(componentWillMountï¼ŒcomponentWillReceivePropsï¼ŒcomponentWillUpdate)éƒ½è¢«getDerivedStateFromPropsæ›¿ä»£ã€‚ä¹Ÿå°±æ˜¯ç”¨ä¸€ä¸ªé™æ€å‡½æ•°getDerivedStateFromPropsæ¥å–ä»£è¢«deprecateçš„å‡ ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå°±æ˜¯å¼ºåˆ¶å¼€å‘è€…åœ¨renderä¹‹å‰åªåšæ— å‰¯ä½œç”¨çš„æ“ä½œï¼Œè€Œä¸”èƒ½åšçš„æ“ä½œå±€é™åœ¨æ ¹æ®propså’Œstateå†³å®šæ–°çš„stateReact v16.0åˆšæ¨å‡ºçš„æ—¶å€™ï¼Œæ˜¯å¢åŠ äº†ä¸€ä¸ªcomponentDidCatchç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå¢é‡å¼ä¿®æ”¹ï¼Œå®Œå…¨ä¸å½±å“åŸæœ‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼›ä½†æ˜¯ï¼Œåˆ°äº†React v16.3ï¼Œå¤§æ”¹åŠ¨æ¥äº†ï¼Œå¼•å…¥äº†ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°</li>
<li>æ–°å¼•å…¥äº†ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼š getDerivedStateFromProps ï¼Œ getSnapshotBeforeUpdate<ul>
<li>getDerivedStateFromProps<ul>
<li>getDerivedStateFromProps æœ¬æ¥ï¼ˆReact v16.3ä¸­ï¼‰æ˜¯åªåœ¨åˆ›å»ºå’Œæ›´æ–°ï¼ˆç”±çˆ¶ç»„ä»¶å¼•å‘éƒ¨åˆ†ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸æ˜¯ä¸ç”±çˆ¶ç»„ä»¶å¼•å‘ï¼Œé‚£ä¹ˆgetDerivedStateFromPropsä¹Ÿä¸ä¼šè¢«è°ƒç”¨ï¼Œå¦‚è‡ªèº«setStateå¼•å‘æˆ–è€…forceUpdateå¼•å‘</li>
</ul>
</li>
</ul>
</li>
<li>React v16.3 è¿™æ ·çš„è¯ç†è§£èµ·æ¥æœ‰ç‚¹ä¹±ï¼Œåœ¨React v16.4ä¸­æ”¹æ­£äº†è¿™ä¸€ç‚¹ï¼Œè®©getDerivedStateFromPropsæ— è®ºæ˜¯Mountingè¿˜æ˜¯Updatingï¼Œä¹Ÿæ— è®ºæ˜¯å› ä¸ºä»€ä¹ˆå¼•èµ·çš„Updatingï¼Œå…¨éƒ¨éƒ½ä¼šè¢«è°ƒç”¨ï¼Œå…·ä½“å¯çœ‹React v16.4 çš„ç”Ÿå‘½å‘¨æœŸå›¾</li>
<li>React v16.4åçš„getDerivedStateFromProps<ul>
<li>static getDerivedStateFromProps(props, state) åœ¨ç»„ä»¶åˆ›å»ºæ—¶å’Œæ›´æ–°æ—¶çš„renderæ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œå®ƒåº”è¯¥è¿”å›ä¸€ä¸ªå¯¹è±¡æ¥æ›´æ–°çŠ¶æ€ï¼Œæˆ–è€…è¿”å›nullæ¥ä¸æ›´æ–°ä»»ä½•å†…å®¹</li>
</ul>
</li>
<li>getSnapshotBeforeUpdate<ul>
<li>getSnapshotBeforeUpdate() è¢«è°ƒç”¨äºrenderä¹‹åï¼Œå¯ä»¥è¯»å–ä½†æ— æ³•ä½¿ç”¨DOMçš„æ—¶å€™ã€‚å®ƒä½¿æ‚¨çš„ç»„ä»¶å¯ä»¥åœ¨å¯èƒ½æ›´æ”¹ä¹‹å‰ä»DOMæ•è·ä¸€äº›ä¿¡æ¯ï¼ˆä¾‹å¦‚æ»šåŠ¨ä½ç½®ï¼‰ã€‚æ­¤ç”Ÿå‘½å‘¨æœŸè¿”å›çš„ä»»ä½•å€¼éƒ½å°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™componentDidUpdateï¼ˆï¼‰<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">class ScrollingList extends React.Component &#123; </span><br><span class="line">  constructor(props) &#123; </span><br><span class="line">    super(props); </span><br><span class="line">    this.listRef = React.createRef(); </span><br><span class="line">  &#125;</span><br><span class="line">  getSnapshotBeforeUpdate(prevProps, prevState) &#123; //æˆ‘ä»¬æ˜¯å¦è¦æ·»åŠ æ–°çš„ items åˆ°åˆ—è¡¨? // æ•æ‰æ»šåŠ¨ä½ç½®ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç¨åè°ƒæ•´æ»šåŠ¨</span><br><span class="line">    if (prevProps.list.length &lt; this.props.list.length) &#123; </span><br><span class="line">      const list = this.listRef.current; </span><br><span class="line">      return list.scrollHeight - list.scrollTop; </span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">  &#125;</span><br><span class="line">  componentDidUpdate(prevProps, prevState, snapshot) &#123; </span><br><span class="line">    //å¦‚æœæˆ‘ä»¬æœ‰snapshotå€¼, æˆ‘ä»¬å·²ç»æ·»åŠ äº† æ–°çš„items </span><br><span class="line">    // è°ƒæ•´æ»šåŠ¨ä»¥è‡³äºè¿™äº›æ–°çš„items ä¸ä¼šå°†æ—§itemsæ¨å‡ºè§†å›¾</span><br><span class="line">    // (è¿™è¾¹çš„snapshotæ˜¯ getSnapshotBeforeUpdateæ–¹æ³•çš„è¿”å›å€¼) </span><br><span class="line">    if (snapshot !== null) &#123; </span><br><span class="line">      const list = this.listRef.current; </span><br><span class="line">      list.scrollTop = list.scrollHeight - snapshot; </span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123; </span><br><span class="line">    return ( &lt;div ref=&#123;this.listRef&#125;&gt;&#123;/* ...contents... */&#125;&lt;/div&gt; ); </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/12/21/reactç»„ä»¶åŒ–/" rel="next" title="reactç»„ä»¶åŒ–">
                <i class="fa fa-chevron-left"></i> reactç»„ä»¶åŒ–
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/12/23/reactåŸç†/" rel="prev" title="reactåŸç†">
                reactåŸç† <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/blog-avatar.jpeg" alt="yongfeng.peng">
            
              <p class="site-author-name" itemprop="name">yongfeng.peng</p>
              <p class="site-description motion-element" itemprop="description">(å¥³è‹±</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">51</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#reactç”Ÿå‘½å‘¨æœŸ-å›¾è°±"><span class="nav-number">1.</span> <span class="nav-text">reactç”Ÿå‘½å‘¨æœŸ å›¾è°±</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#react-v16-0å‰çš„ç”Ÿå‘½å‘¨æœŸ"><span class="nav-number">1.1.</span> <span class="nav-text">react v16.0å‰çš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#react-v16-4-çš„ç”Ÿå‘½å‘¨æœŸ"><span class="nav-number">1.2.</span> <span class="nav-text">react v16.4 çš„ç”Ÿå‘½å‘¨æœŸ</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yongfeng.peng</span>

  
</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
